name: Build Images

on:
  #push:
  workflow_dispatch:

permissions:
  contents: read
  packages: write

jobs:

  cleanup:
    runs-on: [self-hosted, linux]
    needs:
    if: always()
    steps:
      - name: Cleanup
        run: docker image prune -a -f && docker volume prune -f

  proxy:
    runs-on: [self-hosted, linux]
    steps:
      - uses: ComfyMP/images/.github/workflows/build_proxy.yml@main